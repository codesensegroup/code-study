# ğŸ“– å°ˆæ³¨é–±è®€æ¨¡å¼åŠŸèƒ½

å„ªå…ˆç´šï¼š**P2** | é è¨ˆæ™‚é–“ï¼š**1-2 å¤©**

## åŠŸèƒ½æ¦‚è¿°

ç‚ºäº†æå‡ä½¿ç”¨è€…é–±è®€ç­†è¨˜çš„é«”é©—,å¯¦ä½œä¸€å€‹ã€Œå°ˆæ³¨é–±è®€æ¨¡å¼ã€åŠŸèƒ½ã€‚ä½¿ç”¨è€…å¯ä»¥é€éå³ä¸‹è§’çš„æµ®å‹•æŒ‰éˆ•æˆ–å¿«æ·éµ (F/R) åˆ‡æ›æ¨¡å¼,é€²å…¥å°ˆæ³¨é–±è®€æ™‚:

- âœ… **å·¦å´é¸å–®å®Œå…¨éš±è—** - æä¾›æ›´å¯¬å»£çš„é–±è®€ç©ºé–“
- âœ… **å…§å®¹å€åŸŸç½®ä¸­ä¸”æœ€ä½³å¯¬åº¦** - é™åˆ¶åœ¨ç´„ 850px,ç¬¦åˆæœ€ä½³é–±è®€é«”é©—
- âœ… **å³å´ TOC æ‡¸æµ®é¡¯ç¤º** - æ»‘é¼ ç§»åˆ°å³å´é‚Šç·£æ™‚æ»‘å…¥,ä¸å¹²æ“¾é–±è®€
- âœ… **ç‹€æ…‹ä¿å­˜** - ä½¿ç”¨ localStorage è¨˜ä½ä½¿ç”¨è€…åå¥½
- âœ… **å¿«æ·éµæ”¯æ´** - æŒ‰ F æˆ– R éµå¿«é€Ÿåˆ‡æ›

## å¯¦ä½œç‹€æ…‹

**ç‹€æ…‹**: âœ… å·²å®Œæˆä¸¦å„ªåŒ– (v2.0 - 2025-10-09)

## æ›´æ–°æ—¥èªŒ

### v2.0 (2025-10-09) - å„ªåŒ–ç‰ˆæœ¬
**æ–°å¢åŠŸèƒ½:**
- âœ… ç§»é™¤æŒ‰éˆ•æ–‡å­—æ¨™ç±¤,æ”¹ç‚ºç´”åœ–ç¤ºåœ“å½¢æŒ‰éˆ• (æ›´ç°¡æ½”)
- âœ… æ–°å¢ Header è‡ªå‹•éš±è—åŠŸèƒ½ (å‘ä¸‹æ»¾å‹•éš±è—,å‘ä¸Šæ»¾å‹•é¡¯ç¤º)
- âœ… å…§å®¹å¯¬åº¦å¾ 850px å¢åŠ åˆ° 1200px (æä¾›æ›´å¤§é–±è®€ç©ºé–“)
- âœ… æ–°å¢æ»¾å‹•æ–¹å‘åµæ¸¬ composable (`useScrollDirection`)
- âœ… å„ªåŒ–æŒ‰éˆ•å‹•ç•«æ•ˆæœ (æ¿€æ´»æ™‚æ—‹è½‰ 180 åº¦)

**æŠ€è¡“æ”¹é€²:**
- åœ“å½¢æŒ‰éˆ•è¨­è¨ˆ (48px Ã— 48px)
- åœ–ç¤ºæ”¾å¤§åˆ° 28px
- ä½¿ç”¨ `requestAnimationFrame` å„ªåŒ–æ»¾å‹•åµæ¸¬æ•ˆèƒ½
- Header ä½¿ç”¨ `transform: translateY()` å¯¦ç¾æµæš¢éš±è—å‹•ç•«

### v1.0 (2025-10-09) - åˆå§‹ç‰ˆæœ¬
- âœ… åŸºç¤é–±è®€æ¨¡å¼åŠŸèƒ½
- âœ… å·¦å´é¸å–®éš±è—
- âœ… å³å´ TOC æ‡¸æµ®
- âœ… å¿«æ·éµæ”¯æ´ (F/R éµ)
- âœ… localStorage ç‹€æ…‹ä¿å­˜

## æŠ€è¡“å¯¦ä½œ

### 1. é–±è®€æ¨¡å¼ Composable

**æª”æ¡ˆ**: `composables/useReadingMode.ts`

æä¾›å…¨åŸŸçš„é–±è®€æ¨¡å¼ç‹€æ…‹ç®¡ç†:

```typescript
export const useReadingMode = () => {
  // ä½¿ç”¨ useState è®“ç‹€æ…‹åœ¨æ•´å€‹æ‡‰ç”¨ä¸­å…±äº«
  const isReadingMode = useState<boolean>('reading-mode', () => {
    // å¾ localStorage è®€å–ä½¿ç”¨è€…åå¥½
    if (process.client) {
      const saved = localStorage.getItem('reading-mode')
      return saved === 'true'
    }
    return false
  })

  // åˆ‡æ›ã€å•Ÿç”¨ã€åœç”¨é–±è®€æ¨¡å¼çš„å‡½æ•¸
  const toggleReadingMode = () => { ... }
  const enableReadingMode = () => { ... }
  const disableReadingMode = () => { ... }

  // å¿«æ·éµæ”¯æ´ (F æˆ– R éµ)
  // ...

  return {
    isReadingMode: readonly(isReadingMode),
    toggleReadingMode,
    enableReadingMode,
    disableReadingMode,
  }
}
```

**ç‰¹é»**:
- ä½¿ç”¨ `useState` ç¢ºä¿ç‹€æ…‹åœ¨æ•´å€‹æ‡‰ç”¨ä¸­å…±äº«
- ä½¿ç”¨ `localStorage` ä¿å­˜ä½¿ç”¨è€…åå¥½
- è‡ªå‹•è¨­ç½®å¿«æ·éµç›£è½ (F æˆ– R éµ)
- é¿å…åœ¨è¼¸å…¥æ¡†ä¸­èª¤è§¸ç™¼å¿«æ·éµ

### 2. æ»¾å‹•æ–¹å‘åµæ¸¬ Composable (v2.0 æ–°å¢)

**æª”æ¡ˆ**: `composables/useScrollDirection.ts`

åµæ¸¬ä½¿ç”¨è€…æ»¾å‹•æ–¹å‘,ç”¨æ–¼å¯¦ç¾ Header è‡ªå‹•éš±è—:

```typescript
export const useScrollDirection = () => {
  const scrollDirection = useState<'up' | 'down' | null>('scroll-direction', () => null)
  const isAtTop = useState<boolean>('is-at-top', () => true)

  // ä½¿ç”¨ requestAnimationFrame å„ªåŒ–æ•ˆèƒ½
  // æ»¾å‹•è¶…é 5px æ‰è§¸ç™¼,é¿å…å¾®å°æŠ–å‹•
  // æ»¾å‹•è¶…é 100px æ‰é–‹å§‹éš±è— Header

  return {
    scrollDirection: readonly(scrollDirection),
    isAtTop: readonly(isAtTop),
  }
}
```

**ç‰¹é»**:
- ä½¿ç”¨ `requestAnimationFrame` å„ªåŒ–æ•ˆèƒ½
- è¨­ç½® 5px çš„æŠ–å‹•å®¹å¿åº¦
- æ»¾å‹•è¶…é 100px æ‰è§¸ç™¼ Header éš±è—
- åœ¨é ‚éƒ¨æ™‚å§‹çµ‚é¡¯ç¤º Header

### 3. é–±è®€æ¨¡å¼åˆ‡æ›æŒ‰éˆ•

**æª”æ¡ˆ**: `components/ReadingModeToggle.vue`

å›ºå®šåœ¨å³ä¸‹è§’çš„æµ®å‹•æŒ‰éˆ•:

**ç‰¹é» (v2.0 å„ªåŒ–)**:
- **ç´”åœ–ç¤ºè¨­è¨ˆ**: ç§»é™¤æ–‡å­—æ¨™ç±¤,åƒ…é¡¯ç¤ºåœ–ç¤º
- **åœ“å½¢æŒ‰éˆ•**: 48px Ã— 48px åœ“å½¢è¨­è¨ˆ
- **åœ–ç¤ºæ”¾å¤§**: å¾ 20px å¢åŠ åˆ° 28px (æ›´æ˜é¡¯)
- **æ—‹è½‰å‹•ç•«**: æ¿€æ´»æ™‚æ—‹è½‰ 180 åº¦
- **åœ–ç¤ºåˆ‡æ›**: æ›¸æœ¬ ğŸ“– (æœªæ¿€æ´») / çœ¼ç›é—œé–‰ ğŸ‘ï¸â€ğŸ—¨ï¸ (æ¿€æ´»)
- **hover æ•ˆæœ**: å‘ä¸Šæµ®èµ· 4px + ç¸®æ”¾ 1.05 å€
- **åŠé€æ˜èƒŒæ™¯**: backdrop-filter æ¨¡ç³Šæ•ˆæœ

**æ¨£å¼è®ŠåŒ– (v1.0 â†’ v2.0)**:
```css
// v1.0 - é•·æ–¹å½¢æŒ‰éˆ•å¸¶æ–‡å­—
width: auto, height: auto
icon: 20px

// v2.0 - åœ“å½¢ç´”åœ–ç¤ºæŒ‰éˆ•
width: 48px, height: 48px
borderRadius: full (åœ“å½¢)
icon: 28px
transform: rotate(180deg) when active
```

### 4. Header è‡ªå‹•éš±è— (v2.0 æ–°å¢)

**æª”æ¡ˆ**: `components/AppHeader.vue`

Header æ ¹æ“šæ»¾å‹•æ–¹å‘è‡ªå‹•éš±è—/é¡¯ç¤º:

```typescript
const shouldHideHeader = computed(() => {
  // åªæœ‰åœ¨é–±è®€æ¨¡å¼ä¸‹æ‰éš±è—
  if (!isReadingMode.value) return false

  // åœ¨é ‚éƒ¨æ™‚å§‹çµ‚é¡¯ç¤º
  if (isAtTop.value) return false

  // å‘ä¸‹æ»¾å‹•æ™‚éš±è—
  return scrollDirection.value === 'down'
})
```

**å‹•ç•«æ•ˆæœ**:
```css
header {
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);

  &.header-hidden {
    transform: translateY(-100%);
  }
}
```

**ç‰¹é»**:
- ä½¿ç”¨ GPU åŠ é€Ÿçš„ `transform` å¯¦ç¾æµæš¢å‹•ç•«
- åœ¨é é¢é ‚éƒ¨æ™‚å§‹çµ‚é¡¯ç¤º
- åƒ…åœ¨é–±è®€æ¨¡å¼ä¸‹å•Ÿç”¨
- å‘ä¸Šæ»¾å‹•ç«‹å³é¡¯ç¤º

### 5. DocsPageLayout çµ„ä»¶ä¿®æ”¹

**æª”æ¡ˆ**: `components/DocsPageLayout.vue`

ä¿®æ”¹ä½ˆå±€ä»¥æ”¯æ´é–±è®€æ¨¡å¼:

#### ä¿®æ”¹å…§å®¹

1. **å¼•å…¥ composable**:
```typescript
const { isReadingMode } = useReadingMode()
```

2. **æ·»åŠ  CSS é¡åˆ¥**:
```vue
<Container
  :class="{
    // ...å…¶ä»–é¡åˆ¥
    'reading-mode': isReadingMode,
  }"
>
```

3. **æ·»åŠ åˆ‡æ›æŒ‰éˆ•**:
```vue
<!-- Reading Mode Toggle -->
<ReadingModeToggle />
```

#### æ¨£å¼èª¿æ•´

**å·¦å´é¸å–®** (`.aside-nav`):
```css
.reading-mode && {
  transform: translateX(-100%);  // å‘å·¦ç§»å‡ºç•«é¢
  opacity: 0;                     // æ·¡å‡º
  pointer-events: none;           // ç¦ç”¨äº’å‹•
}
```

**å…§å®¹å€åŸŸ** (`.page-body`) - v2.0 æ›´æ–°:
```css
.reading-mode && {
  max-width: 1200px;  // v2.0: å¾ 850px å¢åŠ åˆ° 1200px
  mx: auto;           // ç½®ä¸­é¡¯ç¤º
  px: 3rem;           // å¢åŠ å·¦å³å…§è·

  // åœ–ç‰‡/è¡¨æ ¼/ç¨‹å¼ç¢¼å¯ä»¥å®Œæ•´é¡¯ç¤º
  img, pre, table {
    max-width: 100%;
  }
}
```

**å³å´ TOC** (`.toc`):
```css
.reading-mode && {
  position: fixed;                          // å›ºå®šä½ç½®
  right: 0;                                 // é å³
  transform: translateX(calc(100% - 20px)); // å¤§éƒ¨åˆ†éš±è—,åƒ…éœ²å‡º 20px
  opacity: 0.6;                             // åŠé€æ˜
  z-index: 40;                              // é«˜å±¤ç´š

  &:hover {
    transform: translateX(0);  // hover æ™‚å®Œå…¨é¡¯ç¤º
    opacity: 1;                // å®Œå…¨ä¸é€æ˜
  }
}
```

## ä½¿ç”¨æ–¹å¼

### åˆ‡æ›é–±è®€æ¨¡å¼

1. **é»æ“ŠæŒ‰éˆ•**: é»æ“Šå³ä¸‹è§’çš„æµ®å‹•æŒ‰éˆ•
2. **å¿«æ·éµ**: æŒ‰ `F` æˆ– `R` éµ

### æŸ¥çœ‹ TOC

åœ¨é–±è®€æ¨¡å¼ä¸‹:
1. å°‡æ»‘é¼ ç§»åˆ°ç•«é¢å³å´é‚Šç·£
2. TOC æœƒå¾å³å´æ»‘å…¥é¡¯ç¤º
3. ç§»é–‹æ»‘é¼ å¾Œæœƒè‡ªå‹•éš±è—

## è¨­è¨ˆè€ƒé‡

### æœ€ä½³é–±è®€å¯¬åº¦

æ ¹æ“šç ”ç©¶,æœ€ä½³çš„é–±è®€å¯¬åº¦ç‚º:
- æ¯è¡Œ **50-75 å€‹å­—å…ƒ** (ç´„ 600-900px)
- æˆ‘å€‘é¸æ“‡ **850px** ä½œç‚ºæœ€å¤§å¯¬åº¦
- é€™æ¨£å¯ä»¥æ¸›å°‘çœ¼çƒç§»å‹•,æå‡é–±è®€èˆ’é©åº¦

### ç‚ºä»€éº¼ä¸å®Œå…¨éš±è— TOC?

1. **å¿«é€Ÿå°èˆª**: ä½¿ç”¨è€…å¯èƒ½éš¨æ™‚éœ€è¦è·³è½‰ç« ç¯€
2. **è¦–è¦ºæç¤º**: 20px çš„éœ²å‡ºæé†’ä½¿ç”¨è€… TOC çš„å­˜åœ¨
3. **å¹³æ»‘é«”é©—**: hover é¡¯ç¤ºæ¯”é»æ“Šåˆ‡æ›æ›´æµæš¢

### ç‹€æ…‹ä¿å­˜

ä½¿ç”¨ `localStorage` ä¿å­˜ä½¿ç”¨è€…åå¥½:
- ä½¿ç”¨è€…åˆ‡æ›æ¨¡å¼å¾Œ,ä¸‹æ¬¡è¨ªå•æœƒè‡ªå‹•å¥—ç”¨
- è·¨é é¢ä¿æŒç‹€æ…‹ (åˆ‡æ›ç« ç¯€æ™‚ä¸æœƒé‡ç½®)

## éŸ¿æ‡‰å¼è¨­è¨ˆ

### æ¡Œé¢ç‰ˆ (â‰¥1024px)
- å®Œæ•´åŠŸèƒ½
- å·¦å´é¸å–®éš±è—
- å…§å®¹ç½®ä¸­é™å¯¬
- TOC æ‡¸æµ®é¡¯ç¤º

### å¹³æ¿/æ‰‹æ©Ÿç‰ˆ (<1024px)
- æŒ‰éˆ•æ–‡å­—éš±è— (åƒ…é¡¯ç¤ºåœ–ç¤º)
- TOC ç¶­æŒåŸæœ¬çš„å±•é–‹/æ”¶åˆé‚è¼¯
- å·¦å´é¸å–®æœ¬ä¾†å°±æ˜¯éš±è—çš„ (ç§»å‹•ç‰ˆé è¨­è¡Œç‚º)

## ç€è¦½å™¨æ”¯æ´

- âœ… Chrome/Edge (æœ€æ–°ç‰ˆ)
- âœ… Firefox (æœ€æ–°ç‰ˆ)
- âœ… Safari (æœ€æ–°ç‰ˆ)
- âœ… æ”¯æ´ `localStorage` çš„æ‰€æœ‰ç¾ä»£ç€è¦½å™¨

## æ•ˆèƒ½è€ƒé‡

1. **CSS Transitions**: ä½¿ç”¨ GPU åŠ é€Ÿçš„ `transform` å’Œ `opacity`
2. **äº‹ä»¶å§”è¨—**: å¿«æ·éµäº‹ä»¶åƒ…ç¶å®šä¸€æ¬¡åœ¨ window
3. **ç‹€æ…‹å…±äº«**: ä½¿ç”¨ `useState` é¿å…å¤šå€‹çµ„ä»¶é‡è¤‡é‚è¼¯
4. **å»¶é²åŸ·è¡Œ**: åƒ…åœ¨å®¢æˆ¶ç«¯åŸ·è¡Œ localStorage æ“ä½œ

## æœªä¾†å„ªåŒ–æ–¹å‘

### å¯é¸åŠŸèƒ½

1. **Header è‡ªå‹•éš±è—**
   - å‘ä¸‹æ»¾å‹•æ™‚éš±è— Header
   - å‘ä¸Šæ»¾å‹•æ™‚é¡¯ç¤º
   - æä¾›æ›´å¤§çš„é–±è®€ç©ºé–“

2. **å­—é«”å¤§å°èª¿æ•´**
   - åœ¨é–±è®€æ¨¡å¼ä¸‹æä¾›å­—é«”å¤§å°èª¿æ•´
   - A- / A / A+ æŒ‰éˆ•

3. **ä¸»é¡Œåˆ‡æ›**
   - é–±è®€æ¨¡å¼å°ˆç”¨çš„é…è‰² (å¦‚ç±³è‰²èƒŒæ™¯)
   - å¤œé–“é–±è®€æ¨¡å¼

4. **æ›´å¤šå¿«æ·éµ**
   - `Esc` é€€å‡ºé–±è®€æ¨¡å¼
   - `â†` / `â†’` åˆ‡æ›ä¸Š/ä¸‹ä¸€ç« ç¯€

### æ•ˆèƒ½å„ªåŒ–

1. **å‹•ç•«å„ªåŒ–**
   - ä½¿ç”¨ `will-change` æç¤ºç€è¦½å™¨
   - æ¸›å°‘ reflow/repaint

2. **æƒ°æ€§åŠ è¼‰**
   - é–±è®€æ¨¡å¼ä¸‹å»¶é²åŠ è¼‰ TOC

## æ¸¬è©¦æª¢æŸ¥æ¸…å–®

- [x] é»æ“ŠæŒ‰éˆ•å¯åˆ‡æ›é–±è®€æ¨¡å¼
- [x] æŒ‰ F éµå¯åˆ‡æ›é–±è®€æ¨¡å¼
- [x] æŒ‰ R éµå¯åˆ‡æ›é–±è®€æ¨¡å¼
- [x] åœ¨è¼¸å…¥æ¡†ä¸­æŒ‰ F/R ä¸æœƒè§¸ç™¼åˆ‡æ›
- [x] å·¦å´é¸å–®åœ¨é–±è®€æ¨¡å¼ä¸‹éš±è—
- [x] å…§å®¹å€åŸŸåœ¨é–±è®€æ¨¡å¼ä¸‹ç½®ä¸­é™å¯¬
- [x] TOC åœ¨é–±è®€æ¨¡å¼ä¸‹è®Šç‚ºæ‡¸æµ®æ¨¡å¼
- [x] hover TOC å€åŸŸæ™‚å®Œå…¨é¡¯ç¤º
- [x] ç‹€æ…‹ä¿å­˜åˆ° localStorage
- [x] é‡æ–°è¼‰å…¥é é¢å¾Œç‹€æ…‹ä¿æŒ
- [x] åˆ‡æ›é é¢å¾Œç‹€æ…‹ä¿æŒ
- [x] éŸ¿æ‡‰å¼è¨­è¨ˆåœ¨æ‰‹æ©Ÿä¸Šæ­£å¸¸é‹ä½œ
- [x] æ·±è‰²æ¨¡å¼ä¸‹æ¨£å¼æ­£å¸¸
- [x] éæ¸¡å‹•ç•«æµæš¢

## ç›¸é—œæª”æ¡ˆ

- [composables/useReadingMode.ts](../composables/useReadingMode.ts) - ç‹€æ…‹ç®¡ç†
- [components/ReadingModeToggle.vue](../components/ReadingModeToggle.vue) - åˆ‡æ›æŒ‰éˆ•
- [components/DocsPageLayout.vue](../components/DocsPageLayout.vue) - ä½ˆå±€çµ„ä»¶

## åƒè€ƒè³‡æ–™

- [Web Typography: The Elements of Typographic Style](http://webtypography.net/2.1.2) - æœ€ä½³è¡Œå¯¬
- [Material Design: Reading](https://material.io/design/communication/writing.html) - é–±è®€é«”é©—è¨­è¨ˆ
- [Nuxt 3 State Management](https://nuxt.com/docs/getting-started/state-management) - useState ç”¨æ³•
- [Web Storage API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API) - localStorage ä½¿ç”¨

---

**å®Œæˆæ—¥æœŸ**: 2025-10-09
**å¯¦ä½œè€…**: Claude Code
**å„ªå…ˆç´š**: ğŸ¯ ä¸­é«˜
**å½±éŸ¿ç¯„åœ**: ä½¿ç”¨è€…é«”é©— + é–±è®€èˆ’é©åº¦
