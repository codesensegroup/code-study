<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BFS & DFS è¦–è¦ºåŒ–æ•™å­¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .btn-bfs {
            background: #4CAF50;
            color: white;
        }
        
        .btn-bfs:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        
        .btn-dfs {
            background: #2196F3;
            color: white;
        }
        
        .btn-dfs:hover {
            background: #0b7dda;
            transform: translateY(-2px);
        }
        
        .btn-reset {
            background: #f44336;
            color: white;
        }
        
        .btn-reset:hover {
            background: #da190b;
            transform: translateY(-2px);
        }
        
        .btn-crawler {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-crawler:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .speed-control input {
            width: 150px;
        }
        
        .canvas-container {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: center;
        }
        
        canvas {
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
        }
        
        .info-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-box {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .info-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .info-box ul {
            padding-left: 20px;
        }
        
        .info-box li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        .log {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            min-height: 150px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            border: 2px solid #ddd;
        }
        
        .log-item {
            padding: 5px;
            margin-bottom: 5px;
            border-radius: 4px;
        }
        
        .log-visit {
            background: #e3f2fd;
        }
        
        .log-queue {
            background: #f1f8e9;
        }
        
        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid #333;
        }
        
        .crawler-section {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 15px;
        }
        
        .crawler-demo {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #crawlerAnimation {
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        #crawlerAnimation h2 {
            color: #fff;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .crawler-controls {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .crawler-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        #crawlerStatus {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            color: #fff;
            text-align: center;
            font-family: monospace;
            min-height: 50px;
        }
        
        .crawler-canvas-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
        }
        
        #crawlerLog {
            margin-top: 20px;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            color: #fff;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .crawler-log-item {
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
        }
        
        @media (max-width: 768px) {
            .info-section {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ³ BFS & DFS è¦–è¦ºåŒ–æ•™å­¸</h1>
        <p class="subtitle">å»£åº¦å„ªå…ˆæœå°‹ vs æ·±åº¦å„ªå…ˆæœå°‹</p>
        
        <div class="controls">
            <button class="btn-bfs" onclick="startBFS()">â–¶ åŸ·è¡Œ BFS</button>
            <button class="btn-dfs" onclick="startDFS()">â–¶ åŸ·è¡Œ DFS</button>
            <button class="btn-reset" onclick="resetGraph()">ğŸ”„ é‡ç½®</button>
            <div class="speed-control">
                <label>é€Ÿåº¦ï¼š</label>
                <input type="range" id="speed" min="100" max="2000" value="800" step="100">
                <span id="speedValue">800ms</span>
            </div>
        </div>
        
        <div class="canvas-container">
            <canvas id="canvas" width="700" height="400"></canvas>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #ddd;"></div>
                <span>æœªè¨ªå•</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #FFC107;"></div>
                <span>ç•¶å‰ç¯€é»</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #4CAF50;"></div>
                <span>å·²è¨ªå•</span>
            </div>
        </div>
        
        <div class="info-section">
            <div class="info-box">
                <h3>ğŸŸ¢ BFS (å»£åº¦å„ªå…ˆæœå°‹)</h3>
                <ul>
                    <li><strong>ç­–ç•¥ï¼š</strong>ä¸€å±¤ä¸€å±¤æœå°‹ï¼Œå…ˆè¨ªå•æ‰€æœ‰ç›¸é„°ç¯€é»</li>
                    <li><strong>è³‡æ–™çµæ§‹ï¼š</strong>ä½¿ç”¨ä½‡åˆ— (Queue) - å…ˆé€²å…ˆå‡º</li>
                    <li><strong>ç‰¹é»ï¼š</strong>æ‰¾åˆ°çš„è·¯å¾‘ä¸€å®šæ˜¯æœ€çŸ­è·¯å¾‘</li>
                    <li><strong>é©ç”¨ï¼š</strong>æœ€çŸ­è·¯å¾‘å•é¡Œã€å±¤ç´šéæ­·</li>
                    <li><strong>ç©ºé–“è¤‡é›œåº¦ï¼š</strong>O(V) - éœ€è¦å„²å­˜æ‰€æœ‰åŒå±¤ç¯€é»</li>
                </ul>
            </div>
            
            <div class="info-box">
                <h3>ğŸ”µ DFS (æ·±åº¦å„ªå…ˆæœå°‹)</h3>
                <ul>
                    <li><strong>ç­–ç•¥ï¼š</strong>ä¸€è·¯èµ°åˆ°åº•ï¼Œå†å›é ­æ¢ç´¢å…¶ä»–åˆ†æ”¯</li>
                    <li><strong>è³‡æ–™çµæ§‹ï¼š</strong>ä½¿ç”¨å †ç–Š (Stack) - å¾Œé€²å…ˆå‡º</li>
                    <li><strong>ç‰¹é»ï¼š</strong>æœƒå„ªå…ˆæ¢ç´¢æ·±å±¤ç¯€é»</li>
                    <li><strong>é©ç”¨ï¼š</strong>æ‹“æ’²æ’åºã€è·¯å¾‘æŸ¥æ‰¾ã€è¿·å®®</li>
                    <li><strong>ç©ºé–“è¤‡é›œåº¦ï¼š</strong>O(h) - hç‚ºæ¨¹çš„é«˜åº¦</li>
                </ul>
            </div>
        </div>
        
        <div class="log" id="log">
            <div style="color: #666; font-style: italic;">é»æ“Šä¸Šæ–¹æŒ‰éˆ•é–‹å§‹æ¼”ç¤º...</div>
        </div>
        
        <div class="crawler-section">
            <h2 style="color: #667eea; margin-bottom: 20px; text-align: center;">ğŸ•·ï¸ å¯¦æˆ°æ¼”ç·´ï¼šç¶²é çˆ¬èŸ²ç‚ºä»€éº¼ç”¨ BFSï¼Ÿ</h2>
            
            <div class="crawler-demo">
                <div style="background: white; padding: 25px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="color: #4CAF50; margin-bottom: 15px;">ğŸŸ¢ ä½¿ç”¨ BFS çš„çˆ¬èŸ²ï¼ˆæ¨è–¦ï¼‰</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                        <div>
                            <strong>âœ… å„ªé»ï¼š</strong>
                            <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                                <li><strong>å¹³è¡¡æ¢ç´¢</strong>ï¼šä¸æœƒå¡åœ¨å–®ä¸€ç¶²ç«™å¤ªæ·±</li>
                                <li><strong>ç¦®è²Œçˆ¬å–</strong>ï¼šåˆ†æ•£è«‹æ±‚åˆ°ä¸åŒç¶²ç«™ï¼Œé¿å…éè¼‰</li>
                                <li><strong>å¿«é€Ÿè¦†è“‹</strong>ï¼šå„ªå…ˆç²å–å»£åº¦è³‡è¨Š</li>
                                <li><strong>æ˜“æ–¼æ§åˆ¶</strong>ï¼šå¯è¨­å®šæ·±åº¦é™åˆ¶</li>
                            </ul>
                        </div>
                        <div>
                            <strong>ğŸ¯ å¯¦éš›å ´æ™¯ï¼š</strong>
                            <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                                <li>æœå°‹å¼•æ“ç´¢å¼•ç¶²é </li>
                                <li>æ–°èçˆ¬èŸ²æŠ“å–é ­æ¢</li>
                                <li>ç¤¾ç¾¤åª’é«”çˆ¬å–</li>
                                <li>ç¶²ç«™åœ°åœ–ç”Ÿæˆ</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; padding: 25px; border-radius: 10px;">
                    <h3 style="color: #2196F3; margin-bottom: 15px;">ğŸ”µ ä½¿ç”¨ DFS çš„çˆ¬èŸ²ï¼ˆå•é¡Œå¤šï¼‰</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                        <div>
                            <strong>âš ï¸ ç¼ºé»ï¼š</strong>
                            <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                                <li><strong>å®¹æ˜“å¡ä½</strong>ï¼šå¯èƒ½ä¸€ç›´çˆ¬åŒä¸€ç¶²ç«™çš„æ·±å±¤é é¢</li>
                                <li><strong>ä¼ºæœå™¨éè¼‰</strong>ï¼šçŸ­æ™‚é–“å¤§é‡è«‹æ±‚åŒä¸€ç¶²ç«™</li>
                                <li><strong>è¦†è“‹ä¸å‡</strong>ï¼šèŠ±å¤ªå¤šæ™‚é–“åœ¨å–®ä¸€è·¯å¾‘</li>
                                <li><strong>å¯èƒ½ç„¡é™å¾ªç’°</strong>ï¼šç¶²ç«™å…§éƒ¨é€£çµäº’ç›¸æŒ‡å‘</li>
                            </ul>
                        </div>
                        <div>
                            <strong>ğŸ” å¯èƒ½çš„å ´æ™¯ï¼š</strong>
                            <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                                <li>ç‰¹å®šè³‡æ–™æ·±åº¦æŒ–æ˜</li>
                                <li>å–®ä¸€ç¶²ç«™å®Œæ•´æŠ“å–</li>
                                <li>æª”æ¡ˆç³»çµ±éæ­·</li>
                                <li>éœ€è¦å®Œæ•´è·¯å¾‘çš„æƒ…æ³</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 30px; text-align: center;">
                <button class="btn-crawler" onclick="showCrawlerDemo()">
                    ğŸ¬ æ’­æ”¾çˆ¬èŸ²æ¨¡æ“¬å‹•ç•«
                </button>
            </div>
        </div>
        
        <div style="margin-top: 30px; padding: 25px; background: #f9f9f9; border-radius: 15px;">
            <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ’¡ é—œéµæ´å¯Ÿï¼šç‚ºä»€éº¼çˆ¬èŸ²åå¥½ BFSï¼Ÿ</h3>
            <div style="line-height: 1.8;">
                <p style="margin-bottom: 15px;"><strong>1. é¿å…ã€Œé™·å…¥å…”å­æ´ã€ï¼š</strong>æƒ³åƒä½ è¦èª¿æŸ¥100å€‹ç¶²ç«™çš„é¦–é è³‡è¨Šã€‚ç”¨ DFS å¯èƒ½æœƒåœ¨ç¬¬ä¸€å€‹ç¶²ç«™å°±çˆ¬äº†1000å€‹é é¢ï¼Œè€Œå…¶ä»–99å€‹ç¶²ç«™éƒ½é‚„æ²’çœ‹ï¼</p>
                
                <p style="margin-bottom: 15px;"><strong>2. åˆ†æ•£è«‹æ±‚å£“åŠ›ï¼š</strong>BFS æœƒè¼ªæµè¨ªå•ä¸åŒç¶²ç«™ï¼Œå°±åƒæ’éšŠä¸€æ¨£å…¬å¹³ã€‚DFS å‰‡æœƒé€£çºŒæ•²åŒä¸€å€‹ä¼ºæœå™¨çš„é–€ï¼Œå¯èƒ½è¢«ç•¶æˆæ”»æ“Šï¼</p>
                
                <p style="margin-bottom: 15px;"><strong>3. é‡è¦è³‡è¨Šåœ¨å‰å¹¾å±¤ï¼š</strong>å¤§éƒ¨åˆ†æœ‰åƒ¹å€¼çš„å…§å®¹éƒ½åœ¨ç¶²ç«™çš„å‰å¹¾å±¤ï¼ˆé¦–é ã€åˆ†é¡é ï¼‰ã€‚BFS èƒ½å¿«é€Ÿè¦†è“‹é€™äº›é‡é»ã€‚</p>
                
                <p><strong>4. æ›´å¥½çš„æ§åˆ¶ï¼š</strong>ä½ å¯ä»¥èªªã€Œæˆ‘åªè¦çˆ¬3å±¤æ·±åº¦ã€ï¼ŒBFS æœƒå‡å‹»åœ°çµ¦ä½ æ‰€æœ‰ç¶²ç«™çš„å‰3å±¤ã€‚DFS å‰‡å¯èƒ½åªçµ¦ä½ ä¸€å€‹ç¶²ç«™çš„è¶…æ·±å±¤å…§å®¹ã€‚</p>
            </div>
        </div>
        
        <!-- çˆ¬èŸ²å‹•ç•«æ¨¡æ“¬å€ -->
        <div id="crawlerAnimation" style="display: none;">
            <h2>ğŸ•·ï¸ ç¶²é çˆ¬èŸ²è¦–è¦ºåŒ–æ¨¡æ“¬</h2>
            
            <div class="crawler-controls">
                <div class="crawler-buttons">
                    <button class="btn-bfs" onclick="simulateBFSCrawler()">ğŸŸ¢ æ¨¡æ“¬ BFS çˆ¬èŸ²</button>
                    <button class="btn-dfs" onclick="simulateDFSCrawler()">ğŸ”µ æ¨¡æ“¬ DFS çˆ¬èŸ²</button>
                    <button class="btn-reset" onclick="resetCrawlerAnimation()">ğŸ”„ é‡ç½®</button>
                    <button class="btn-reset" onclick="closeCrawlerAnimation()">âœ– é—œé–‰</button>
                </div>
                
                <div id="crawlerStatus">æº–å‚™é–‹å§‹çˆ¬èŸ²æ¨¡æ“¬...</div>
            </div>
            
            <div class="crawler-canvas-container">
                <canvas id="crawlerCanvas" width="700" height="500"></canvas>
            </div>
            
            <div id="crawlerLog"></div>
        </div>
    </div>

    <script>
        // ===== å…¨åŸŸè®Šæ•¸ =====
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const log = document.getElementById('log');
        const speedSlider = document.getElementById('speed');
        const speedValue = document.getElementById('speedValue');
        
        let animationSpeed = 800;
        let isRunning = false;
        
        speedSlider.addEventListener('input', (e) => {
            animationSpeed = e.target.value;
            speedValue.textContent = e.target.value + 'ms';
        });
        
        // ===== åŸºç¤åœ–çš„ç¯€é» =====
        const nodes = [
            { id: 'A', x: 350, y: 50, neighbors: ['B', 'C'] },
            { id: 'B', x: 200, y: 150, neighbors: ['A', 'D', 'E'] },
            { id: 'C', x: 500, y: 150, neighbors: ['A', 'F', 'G'] },
            { id: 'D', x: 100, y: 250, neighbors: ['B', 'H'] },
            { id: 'E', x: 300, y: 250, neighbors: ['B', 'I'] },
            { id: 'F', x: 450, y: 250, neighbors: ['C'] },
            { id: 'G', x: 600, y: 250, neighbors: ['C', 'J'] },
            { id: 'H', x: 50, y: 350, neighbors: ['D'] },
            { id: 'I', x: 250, y: 350, neighbors: ['E'] },
            { id: 'J', x: 650, y: 350, neighbors: ['G'] }
        ];
        
        const nodeMap = {};
        nodes.forEach(node => {
            nodeMap[node.id] = node;
            node.visited = false;
            node.current = false;
        });
        
        // ===== çˆ¬èŸ²æ¨¡æ“¬çš„ç¶²ç«™ç¯€é» =====
        const crawlerWebsites = [
            { id: 'Home', x: 350, y: 50, children: ['News', 'Products', 'About'], color: '#ff6b6b', domain: 'example.com', visited: false, current: false },
            { id: 'News', x: 150, y: 150, children: ['News1', 'News2'], color: '#4ecdc4', domain: 'example.com', visited: false, current: false },
            { id: 'Products', x: 350, y: 150, children: ['Prod1', 'Prod2'], color: '#45b7d1', domain: 'example.com', visited: false, current: false },
            { id: 'About', x: 550, y: 150, children: ['Team', 'Contact'], color: '#96ceb4', domain: 'example.com', visited: false, current: false },
            { id: 'News1', x: 80, y: 270, children: ['Detail1'], color: '#ffeaa7', domain: 'news.example.com', visited: false, current: false },
            { id: 'News2', x: 220, y: 270, children: ['Detail2'], color: '#dfe6e9', domain: 'news.example.com', visited: false, current: false },
            { id: 'Prod1', x: 300, y: 270, children: ['Spec1'], color: '#74b9ff', domain: 'shop.example.com', visited: false, current: false },
            { id: 'Prod2', x: 400, y: 270, children: ['Spec2'], color: '#a29bfe', domain: 'shop.example.com', visited: false, current: false },
            { id: 'Team', x: 500, y: 270, children: [], color: '#fd79a8', domain: 'about.example.com', visited: false, current: false },
            { id: 'Contact', x: 600, y: 270, children: [], color: '#fdcb6e', domain: 'about.example.com', visited: false, current: false },
            { id: 'Detail1', x: 80, y: 390, children: [], color: '#fab1a0', domain: 'news.example.com', visited: false, current: false },
            { id: 'Detail2', x: 220, y: 390, children: [], color: '#ff7675', domain: 'news.example.com', visited: false, current: false },
            { id: 'Spec1', x: 300, y: 390, children: [], color: '#6c5ce7', domain: 'shop.example.com', visited: false, current: false },
            { id: 'Spec2', x: 400, y: 390, children: [], color: '#00b894', domain: 'shop.example.com', visited: false, current: false }
        ];
        
        const crawlerWebsiteMap = {};
        crawlerWebsites.forEach(site => {
            crawlerWebsiteMap[site.id] = site;
        });
        
        // ===== è¼”åŠ©å‡½æ•¸ =====
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        function addLog(message, type = '') {
            const logItem = document.createElement('div');
            logItem.className = 'log-item ' + type;
            logItem.textContent = message;
            log.appendChild(logItem);
            log.scrollTop = log.scrollHeight;
        }
        
        function addCrawlerLog(message, type = '') {
            const crawlerLog = document.getElementById('crawlerLog');
            if (!crawlerLog) return;
            
            const logItem = document.createElement('div');
            logItem.className = 'crawler-log-item';
            logItem.style.borderLeft = '4px solid ' + (type === 'bfs' ? '#4CAF50' : type === 'dfs' ? '#2196F3' : '#FFC107');
            logItem.textContent = message;
            crawlerLog.appendChild(logItem);
            crawlerLog.scrollTop = crawlerLog.scrollHeight;
        }
        
        // ===== åŸºç¤åœ–ç¹ªè£½å‡½æ•¸ =====
        function drawGraph() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç¹ªè£½é‚Š
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 2;
            nodes.forEach(node => {
                node.neighbors.forEach(neighborId => {
                    const neighbor = nodeMap[neighborId];
                    if (neighbor && nodes.indexOf(node) < nodes.indexOf(neighbor)) {
                        ctx.beginPath();
                        ctx.moveTo(node.x, node.y);
                        ctx.lineTo(neighbor.x, neighbor.y);
                        ctx.stroke();
                    }
                });
            });
            
            // ç¹ªè£½ç¯€é»
            nodes.forEach(node => {
                ctx.beginPath();
                ctx.arc(node.x, node.y, 25, 0, Math.PI * 2);
                
                if (node.current) {
                    ctx.fillStyle = '#FFC107';
                } else if (node.visited) {
                    ctx.fillStyle = '#4CAF50';
                } else {
                    ctx.fillStyle = '#ddd';
                }
                
                ctx.fill();
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#333';
                ctx.font = 'bold 18px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(node.id, node.x, node.y);
            });
        }
        
        // ===== çˆ¬èŸ²åœ–ç¹ªè£½å‡½æ•¸ =====
        function drawWebStructure() {
            const crawlerCanvas = document.getElementById('crawlerCanvas');
            if (!crawlerCanvas) return;
            
            const crawlerCtx = crawlerCanvas.getContext('2d');
            crawlerCtx.clearRect(0, 0, crawlerCanvas.width, crawlerCanvas.height);
            
            // ç¹ªè£½é€£ç·š
            crawlerCtx.strokeStyle = '#ccc';
            crawlerCtx.lineWidth = 2;
            crawlerWebsites.forEach(site => {
                site.children.forEach(childId => {
                    const child = crawlerWebsiteMap[childId];
                    if (child) {
                        crawlerCtx.beginPath();
                        crawlerCtx.moveTo(site.x, site.y);
                        crawlerCtx.lineTo(child.x, child.y);
                        crawlerCtx.stroke();
                    }
                });
            });
            
            // ç¹ªè£½ç¶²ç«™ç¯€é»
            crawlerWebsites.forEach(site => {
                crawlerCtx.save();
                
                if (site.current) {
                    crawlerCtx.shadowBlur = 20;
                    crawlerCtx.shadowColor = '#FFC107';
                }
                
                crawlerCtx.beginPath();
                crawlerCtx.arc(site.x, site.y, 30, 0, Math.PI * 2);
                
                if (site.current) {
                    crawlerCtx.fillStyle = '#FFC107';
                } else if (site.visited) {
                    crawlerCtx.fillStyle = '#4CAF50';
                } else {
                    crawlerCtx.fillStyle = site.color;
                }
                
                crawlerCtx.fill();
                crawlerCtx.shadowBlur = 0;
                crawlerCtx.strokeStyle = '#333';
                crawlerCtx.lineWidth = 2;
                crawlerCtx.stroke();
                crawlerCtx.restore();
                
                crawlerCtx.fillStyle = '#000';
                crawlerCtx.font = 'bold 12px Arial';
                crawlerCtx.textAlign = 'center';
                crawlerCtx.textBaseline = 'middle';
                crawlerCtx.fillText(site.id, site.x, site.y);
                
                crawlerCtx.fillStyle = '#666';
                crawlerCtx.font = '9px Arial';
                crawlerCtx.fillText(site.domain, site.x, site.y + 45);
            });
        }
        
        // ===== BFS æ¼”ç®—æ³• =====
        async function startBFS() {
            if (isRunning) return;
            isRunning = true;
            resetGraph();
            
            addLog('=== é–‹å§‹ BFSï¼ˆå»£åº¦å„ªå…ˆæœå°‹ï¼‰===', 'log-queue');
            addLog('ä½¿ç”¨ä½‡åˆ— (Queue)ï¼Œå…ˆé€²å…ˆå‡º');
            
            const queue = ['A'];
            const visited = new Set();
            
            while (queue.length > 0) {
                const currentId = queue.shift();
                const currentNode = nodeMap[currentId];
                
                if (visited.has(currentId)) continue;
                
                currentNode.current = true;
                drawGraph();
                addLog(`æ­£åœ¨è¨ªå•ç¯€é»ï¼š${currentId}`, 'log-visit');
                await sleep(animationSpeed);
                
                currentNode.visited = true;
                currentNode.current = false;
                visited.add(currentId);
                
                const unvisitedNeighbors = currentNode.neighbors.filter(n => !visited.has(n));
                if (unvisitedNeighbors.length > 0) {
                    queue.push(...unvisitedNeighbors);
                    addLog(`  â†’ å°‡ [${unvisitedNeighbors.join(', ')}] åŠ å…¥ä½‡åˆ—`, 'log-queue');
                    addLog(`  â†’ ç•¶å‰ä½‡åˆ—ï¼š[${queue.join(', ')}]`, 'log-queue');
                }
                
                drawGraph();
                await sleep(animationSpeed / 2);
            }
            
            addLog('=== BFS å®Œæˆï¼===', 'log-queue');
            isRunning = false;
        }
        
        // ===== DFS æ¼”ç®—æ³• =====
        async function startDFS() {
            if (isRunning) return;
            isRunning = true;
            resetGraph();
            
            addLog('=== é–‹å§‹ DFSï¼ˆæ·±åº¦å„ªå…ˆæœå°‹ï¼‰===', 'log-queue');
            addLog('ä½¿ç”¨å †ç–Š (Stack)ï¼Œå¾Œé€²å…ˆå‡º');
            
            const visited = new Set();
            
            async function dfsVisit(nodeId, depth = 0) {
                if (visited.has(nodeId)) return;
                
                const currentNode = nodeMap[nodeId];
                const indent = '  '.repeat(depth);
                
                currentNode.current = true;
                drawGraph();
                addLog(`${indent}æ­£åœ¨è¨ªå•ç¯€é»ï¼š${nodeId} (æ·±åº¦ï¼š${depth})`, 'log-visit');
                await sleep(animationSpeed);
                
                currentNode.visited = true;
                currentNode.current = false;
                visited.add(nodeId);
                drawGraph();
                
                for (const neighborId of currentNode.neighbors) {
                    if (!visited.has(neighborId)) {
                        addLog(`${indent}  â†’ æ·±å…¥æ¢ç´¢ï¼š${neighborId}`, 'log-queue');
                        await sleep(animationSpeed / 2);
                        await dfsVisit(neighborId, depth + 1);
                        addLog(`${indent}  â† å›æº¯åˆ°ï¼š${nodeId}`, 'log-queue');
                    }
                }
            }
            
            await dfsVisit('A');
            addLog('=== DFS å®Œæˆï¼===', 'log-queue');
            isRunning = false;
        }
        
        // ===== é‡ç½®åœ– =====
        function resetGraph() {
            nodes.forEach(node => {
                node.visited = false;
                node.current = false;
            });
            log.innerHTML = '';
            drawGraph();
        }
        
        // ===== çˆ¬èŸ²å‹•ç•«å‡½æ•¸ =====
        function showCrawlerDemo() {
            crawlerWebsites.forEach(site => {
                site.visited = false;
                site.current = false;
            });
            
            const animationDiv = document.getElementById('crawlerAnimation');
            animationDiv.style.display = 'block';
            
            setTimeout(() => {
                animationDiv.scrollIntoView({ behavior: 'smooth' });
            }, 100);
            
            const status = document.getElementById('crawlerStatus');
            const crawlerLog = document.getElementById('crawlerLog');
            
            if (crawlerLog) crawlerLog.innerHTML = '';
            if (status) status.textContent = 'ğŸ‘† è«‹é¸æ“‡è¦æ¨¡æ“¬çš„çˆ¬èŸ²é¡å‹ï¼ˆDFS æˆ– BFSï¼‰';
            
            setTimeout(() => {
                drawWebStructure();
            }, 300);
        }
        
        function closeCrawlerAnimation() {
            document.getElementById('crawlerAnimation').style.display = 'none';
            crawlerWebsites.forEach(site => {
                site.visited = false;
                site.current = false;
            });
        }
        
        function resetCrawlerAnimation() {
            // åœæ­¢æ­£åœ¨åŸ·è¡Œçš„çˆ¬èŸ²
            isRunning = false;
            
            crawlerWebsites.forEach(site => {
                site.visited = false;
                site.current = false;
            });
            
            const crawlerLogDiv = document.getElementById('crawlerLog');
            if (crawlerLogDiv) crawlerLogDiv.innerHTML = '';
            
            const status = document.getElementById('crawlerStatus');
            if (status) status.textContent = 'ğŸ‘† è«‹é¸æ“‡è¦æ¨¡æ“¬çš„çˆ¬èŸ²é¡å‹ï¼ˆBFS æˆ– DFSï¼‰';
            
            drawWebStructure();
        }
        
        // ===== DFS çˆ¬èŸ²æ¨¡æ“¬ =====
        async function simulateDFSCrawler() {
            if (isRunning) return;
            isRunning = true;
            
            crawlerWebsites.forEach(site => {
                site.visited = false;
                site.current = false;
            });
            
            const crawlerLogDiv = document.getElementById('crawlerLog');
            if (crawlerLogDiv) crawlerLogDiv.innerHTML = '';
            
            const status = document.getElementById('crawlerStatus');
            if (status) status.textContent = 'ğŸ”µ DFS çˆ¬èŸ²åŸ·è¡Œä¸­...';
            
            drawWebStructure();
            
            addCrawlerLog('=== é–‹å§‹ DFS çˆ¬èŸ² ===', 'dfs');
            addCrawlerLog('ç‰¹é»ï¼šä¸€è·¯çˆ¬åˆ°åº•ï¼Œæ·±å…¥æ¢ç´¢å–®ä¸€è·¯å¾‘', 'dfs');
            
            await sleep(1000);
            
            const visited = new Set();
            let requestCount = {};
            
            async function dfsCrawl(siteId, depth = 0) {
                if (!isRunning || visited.has(siteId)) return;
                
                const site = crawlerWebsiteMap[siteId];
                const indent = '  '.repeat(depth);
                
                requestCount[site.domain] = (requestCount[site.domain] || 0) + 1;
                
                site.current = true;
                drawWebStructure();
                addCrawlerLog(`${indent}ğŸ•·ï¸ æ­£åœ¨çˆ¬å–: ${site.id} (${site.domain}) - æ·±åº¦ ${depth}`, 'dfs');
                await sleep(animationSpeed);
                
                if (!isRunning) return;
                
                site.visited = true;
                site.current = false;
                visited.add(siteId);
                drawWebStructure();
                
                if (site.children.length > 0) {
                    addCrawlerLog(`${indent}  â†’ ç™¼ç¾ ${site.children.length} å€‹é€£çµï¼Œæ·±å…¥ç¬¬ä¸€å€‹...`, 'dfs');
                }
                
                for (const childId of site.children) {
                    if (!isRunning) return;
                    if (!visited.has(childId)) {
                        await sleep(animationSpeed / 2);
                        await dfsCrawl(childId, depth + 1);
                    }
                }
            }
            
            await dfsCrawl('Home');
            
            if (!isRunning) {
                addCrawlerLog('', 'dfs');
                addCrawlerLog('âš ï¸ DFS çˆ¬èŸ²å·²è¢«ä¸­æ–·', 'dfs');
                if (status) status.textContent = 'âš ï¸ DFS çˆ¬èŸ²å·²è¢«ä¸­æ–·';
                return;
            }
            
            addCrawlerLog('', 'dfs');
            addCrawlerLog('=== DFS å®Œæˆ ===', 'dfs');
            addCrawlerLog('ğŸ“Š å„ç¶²åŸŸè«‹æ±‚æ¬¡æ•¸çµ±è¨ˆ:', 'dfs');
            Object.keys(requestCount).forEach(domain => {
                addCrawlerLog(`   ${domain}: ${requestCount[domain]} æ¬¡è«‹æ±‚`, 'dfs');
            });
            addCrawlerLog('âš ï¸ æ³¨æ„ï¼šæŸäº›ç¶²åŸŸå¯èƒ½è¢«é€£çºŒè«‹æ±‚å¤šæ¬¡ï¼', 'dfs');
            
            if (status) status.textContent = 'âœ… DFS çˆ¬èŸ²å®Œæˆ - æ³¨æ„è§€å¯Ÿçˆ¬å–é †åºæ˜¯å¦é›†ä¸­åœ¨å–®ä¸€è·¯å¾‘';
            isRunning = false;
        }
        
        // ===== BFS çˆ¬èŸ²æ¨¡æ“¬ =====
        async function simulateBFSCrawler() {
            if (isRunning) return;
            isRunning = true;
            
            crawlerWebsites.forEach(site => {
                site.visited = false;
                site.current = false;
            });
            
            const crawlerLogDiv = document.getElementById('crawlerLog');
            if (crawlerLogDiv) crawlerLogDiv.innerHTML = '';
            
            const status = document.getElementById('crawlerStatus');
            if (status) status.textContent = 'ğŸŸ¢ BFS çˆ¬èŸ²åŸ·è¡Œä¸­...';
            
            drawWebStructure();
            
            addCrawlerLog('=== é–‹å§‹ BFS çˆ¬èŸ² ===', 'bfs');
            addCrawlerLog('ç‰¹é»ï¼šå±¤å±¤æ¨é€²ï¼Œå¹³è¡¡æ¢ç´¢æ‰€æœ‰ç¶²ç«™', 'bfs');
            
            await sleep(1000);
            
            const queue = ['Home'];
            const visited = new Set();
            let currentDepth = 0;
            let nodesAtDepth = { 0: 1 };
            let processedAtDepth = 0;
            let requestCount = {};
            
            while (queue.length > 0 && isRunning) {
                const siteId = queue.shift();
                const site = crawlerWebsiteMap[siteId];
                
                if (visited.has(siteId)) continue;
                
                processedAtDepth++;
                if (processedAtDepth > nodesAtDepth[currentDepth]) {
                    currentDepth++;
                    processedAtDepth = 1;
                    addCrawlerLog('', 'bfs');
                    addCrawlerLog(`--- é€²å…¥ç¬¬ ${currentDepth} å±¤ ---`, 'bfs');
                }
                
                requestCount[site.domain] = (requestCount[site.domain] || 0) + 1;
                
                site.current = true;
                drawWebStructure();
                addCrawlerLog(`ğŸ•·ï¸ çˆ¬å–: ${site.id} (${site.domain})`, 'bfs');
                await sleep(animationSpeed);
                
                if (!isRunning) break;
                
                site.visited = true;
                site.current = false;
                visited.add(siteId);
                drawWebStructure();
                
                const unvisitedChildren = site.children.filter(c => !visited.has(c));
                if (unvisitedChildren.length > 0) {
                    queue.push(...unvisitedChildren);
                    addCrawlerLog(`  â†’ å°‡ [${unvisitedChildren.join(', ')}] åŠ å…¥ä½‡åˆ—`, 'bfs');
                    
                    if (!nodesAtDepth[currentDepth + 1]) {
                        nodesAtDepth[currentDepth + 1] = 0;
                    }
                    nodesAtDepth[currentDepth + 1] += unvisitedChildren.length;
                }
                
                await sleep(animationSpeed / 2);
            }
            
            if (!isRunning) {
                addCrawlerLog('', 'bfs');
                addCrawlerLog('âš ï¸ BFS çˆ¬èŸ²å·²è¢«ä¸­æ–·', 'bfs');
                if (status) status.textContent = 'âš ï¸ BFS çˆ¬èŸ²å·²è¢«ä¸­æ–·';
                return;
            }
            
            addCrawlerLog('', 'bfs');
            addCrawlerLog('=== BFS å®Œæˆ ===', 'bfs');
            addCrawlerLog('ğŸ“Š å„ç¶²åŸŸè«‹æ±‚æ¬¡æ•¸çµ±è¨ˆ:', 'bfs');
            Object.keys(requestCount).forEach(domain => {
                addCrawlerLog(`   ${domain}: ${requestCount[domain]} æ¬¡è«‹æ±‚`, 'bfs');
            });
            addCrawlerLog('âœ… å„ªå‹¢ï¼šè«‹æ±‚åˆ†æ•£åˆ°ä¸åŒç¶²åŸŸï¼Œä¸æœƒéè¼‰å–®ä¸€ä¼ºæœå™¨', 'bfs');
            
            if (status) status.textContent = 'âœ… BFS çˆ¬èŸ²å®Œæˆ - æ³¨æ„è§€å¯Ÿå¦‚ä½•å¹³è¡¡åœ°æ¢ç´¢å„å€‹ç¶²ç«™';
            isRunning = false;
        }
        
        // ===== åˆå§‹åŒ– =====
        drawGraph();
    </script>
</body>
</html>
