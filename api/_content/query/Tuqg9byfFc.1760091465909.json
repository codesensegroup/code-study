{"_path":"/sdi-aig/chapter7","_dir":"sdi-aig","_draft":false,"_partial":false,"_locale":"","title":"07 è¨­è¨ˆå¯ç”¨æ–¼åˆ†æ•£å¼ç³»çµ±çš„å”¯ä¸€IDç”Ÿæˆå™¨","description":"","pageTitle":"Chapter 7 è¨­è¨ˆå¯ç”¨æ–¼åˆ†æ•£å¼ç³»çµ±çš„å”¯ä¸€IDç”Ÿæˆå™¨","contributors":["jacksnow811"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Figure 7-1","src":"/code-study/images/sdi-aig/07/figure7-1.jpg"},"children":[]}]},{"type":"element","tag":"h3","props":{"id":"ç¬¬1æ­¥äº†è§£å•é¡Œä¸¦ç¢ºç«‹è¨­è¨ˆçš„ç¯„åœ"},"children":[{"type":"text","value":"ç¬¬1æ­¥ï¼šäº†è§£å•é¡Œä¸¦ç¢ºç«‹è¨­è¨ˆçš„ç¯„åœ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç‚ºäº†é‡æ¸…ç‹€æ³è€Œæå‡ºå•é¡Œï¼Œæ˜¯è§£æ±ºä»»ä½•ç³»çµ±è¨­è¨ˆé¢è©¦å•é¡Œçš„ç¬¬ä¸€æ­¥ã€‚é€™è£¡æœ‰ä¸€äº›æ‡‰è©¦è€…èˆ‡é¢è©¦å®˜äº’å‹•çš„ä¾‹å­:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ‡‰è©¦è€…:å”¯ä¸€ ID çš„ç‰¹æ€§æ˜¯ä»€éº¼?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é¢è©¦å®˜:ID å¿…é ˆæ˜¯å”¯ä¸€è€Œä¸å¯é‡è¤‡ï¼Œè€Œä¸”å¯é€²è¡Œæ’åºã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ‡‰è©¦è€…:é‡å°æ¯ä¸€å€‹æ–°è¨˜éŒ„ï¼ŒID éƒ½è¦å¢åŠ 1å—?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é¢è©¦å®˜:ID è¦éš¨æ™‚é–“éå¢ï¼Œä½†ä¸ä¸€å®šåªéå¢1ã€‚æ™šä¸Šæ‰€å»ºç«‹çš„IDï¼Œå¿…é ˆå¤§æ–¼ç•¶å¤©æ—©ä¸Šæ‰€å»ºç«‹çš„IDã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ‡‰è©¦è€…:IDçš„å€¼åªèƒ½åŒ…å«æ•¸å€¼å—?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é¢è©¦å®˜:æ˜¯çš„ï¼Œæ²’éŒ¯ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ‡‰è©¦è€…:ID çš„é•·åº¦æœ‰ä»€éº¼è¦æ±‚?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é¢è©¦å®˜:ID æ‡‰è©²ç‚º 64ä½å…ƒã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ‡‰è©¦è€…:ç³»çµ±çš„è¦æ¨¡æœ‰å¤šå¤§?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é¢è©¦å®˜:ç³»çµ±æ‡‰è©²è¦èƒ½å¤ æ¯ç§’ç”Ÿæˆ10000å€‹IDã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä»¥ä¸Šå°±æ˜¯ä¸€äº›ä½ å¯ä»¥è©¢å•é¢è©¦å®˜çš„å•é¡Œç¯„ä¾‹ã€‚é‡è¦çš„æ˜¯ä¸€å®šè¦ç­è§£è¦æ±‚ï¼Œä¸¦é‡æ¸…æ‰€æœ‰ä¸æ¸…æ¥šçš„éƒ¨åˆ†ã€‚é‡å°é€™å€‹é¢è©¦å•é¡Œï¼Œç›¸æ‡‰çš„è¦æ±‚åˆ—è¡¨å¦‚ä¸‹:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ID å¿…é¡»æ˜¯å”¯ä¸€è€Œä¸é‡è¤‡çš„ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ID çš„å€¼åªèƒ½æ˜¯æ•¸å€¼ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ID å¿…é ˆ 64 ä½å…ƒ(bits)ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ID é ˆä¾å¾ªæ™‚é–“çš„é †åºã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"æ¯ç§’è¦èƒ½å¤ ç”Ÿæˆ10000å€‹ä»¥ä¸Šçš„å”¯ä¸€IDã€‚"}]}]},{"type":"element","tag":"h3","props":{"id":"ç¬¬2æ­¥æå‡ºé«˜éšè¨­è¨ˆä¸¦å–å¾—èªå¯"},"children":[{"type":"text","value":"ç¬¬2æ­¥ï¼šæå‡ºé«˜éšè¨­è¨ˆä¸¦å–å¾—èªå¯"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä½œè€…ä»‹ç´¹äº†ä»¥ä¸‹å››ç¨®æ–¹å¼ä¾†å¯¦ä½œï¼š"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"å¤šmasterè¤‡è£½(Multi-master replicaiton)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"UUID (é€šç”¨å”¯ä¸€æ¨™è­˜ç¬¦è™Ÿ)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ç¥¨è­‰ä¼ºæœå™¨ (Ticket Server)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Twitteré›ªç‰‡(snowflake)åšæ³•"}]}]},{"type":"element","tag":"h4","props":{"id":"å¤šmasterè¤‡è£½multi-master-replicaiton"},"children":[{"type":"text","value":"å¤šmasterè¤‡è£½(Multi-master replicaiton)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Figure 7-2","src":"/code-study/images/sdi-aig/07/figure7-2.jpg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é€™ç¨®åšæ³•æœƒç”¨åˆ°è³‡æ–™åº«çš„ "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"auto_increment"}]},{"type":"text","value":" åŠŸèƒ½ã€‚ä¸éæˆ‘å€‘ä¸¦ä¸æ˜¯æŠŠä¸‹ä¸€å€‹IDå¢åŠ 1ï¼Œè€Œæ˜¯å¢åŠ ï¼Œå…¶ä¸­çš„å°±æ˜¯æ‰€ä½¿ç”¨è³‡æ–™åº«ä¼ºæœå™¨çš„æ•¸é‡ã€‚å¦‚åœ–7-2 æ‰€ç¤ºï¼Œåªè¦æŠŠåŒä¸€å€‹ä¼ºæœå™¨çš„å‰ä¸€å€‹IDåŠ ä¸Š2ï¼Œå°±å¯ä»¥ç”Ÿæˆä¸‹ä¸€å€‹IDã€‚é€™ç¨®åšæ³•è§£æ±ºäº†ä¸€äº›å¯æ“´å±•æ€§çš„å•é¡Œï¼Œå› ç‚º ID å¯æ ¹æ“šè³‡æ–™åº«ä¼ºæœå™¨çš„æ•¸é‡é€²è¡Œæ“´å±•ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä¸éï¼Œé€™å€‹ç­–ç•¥æœ‰ä¸€äº›ä¸»è¦çš„ç¼ºé»:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"å¦‚æœæ˜¯æ¡ç”¨å¤šå€‹è³‡æ–™ä¸­å¿ƒï¼Œé€™ç¨®åšæ³•å°±é›£ä»¥é€²è¡Œæ“´å±•ã€‚ğŸ“Œæ¯å€‹è³‡æ–™åº«éƒ½è¦èª¿æ•´"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"auto_increment"}]},{"type":"text","value":"å€¼ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ç”±å¤šéƒ¨ä¼ºæœå™¨åˆ†åˆ¥å¾—å‡ºçš„IDï¼Œå…¶å€¼ä¸¦ä¸ä¸€å®šéš¨è‘—æ™‚é–“è€Œå¢åŠ ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"æ·»åŠ æˆ–ç§»é™¤ä¼ºæœå™¨æ™‚ï¼Œæ“´å±•æ€§ä¸¦ä¸å¥½ã€‚"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"auto_increment"}]},{"type":"text","value":" å¦‚ä¸‹:"}]},{"type":"element","tag":"pre","props":{"className":"language-sql shiki shiki-themes github-dark github-light monokai","code":"-- è¨­å®šå…¨åŸŸæ­¥é€²å€¼ (å½±éŸ¿æ‰€æœ‰è¡¨)\nSET @@auto_increment_increment = 2;\n\n-- æˆ–è€…åªå½±éŸ¿ç•¶å‰ session\nSET SESSION auto_increment_increment = 2;\n","language":"sql","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"-- è¨­å®šå…¨åŸŸæ­¥é€²å€¼ (å½±éŸ¿æ‰€æœ‰è¡¨)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"SET"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" @@auto_increment_increment "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" 2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"-- æˆ–è€…åªå½±éŸ¿ç•¶å‰ session\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"SET"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" SESSION"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" auto_increment_increment "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" 2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":";\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-sql shiki shiki-themes github-dark github-light monokai","code":"CREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEYï¼Œ\n    name VARCHAR(50)\n);\n\nSET SESSION auto_increment_increment = 3;  -- æ¯æ¬¡ +3\n\nINSERT INTO users (name) VALUES ('Alice');\nINSERT INTO users (name) VALUES ('Bob');\nINSERT INTO users (name) VALUES ('Charlie');\n\n-- çµæœï¼š\n-- id | name\n--  1 | Alice\n--  4 | Bob\n--  7 | Charlie\n\n","language":"sql","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"CREATE"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" TABLE"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":" users"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" (\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    id "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#66D9EF;--shiki-dark-font-style:inherit;--shiki-default-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"INT"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" AUTO_INCREMENT "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"PRIMARY KEY"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"ï¼Œ\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"    name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#66D9EF;--shiki-dark-font-style:inherit;--shiki-default-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" VARCHAR"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"50"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"SET"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" SESSION"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" auto_increment_increment "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" 3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":";  "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"-- æ¯æ¬¡ +3\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"INSERT INTO"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" users ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"VALUES"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"'Alice'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"INSERT INTO"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" users ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"VALUES"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"'Bob'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"INSERT INTO"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" users ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"VALUES"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"'Charlie'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"-- çµæœï¼š\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"-- id | name\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"--  1 | Alice\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"--  4 | Bob\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#6A737D;--shiki-default:#6A737D;--shiki-sepia:#88846F"},"children":[{"type":"text","value":"--  7 | Charlie\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"uuid-é€šç”¨å”¯ä¸€æ¨™è­˜ç¬¦è™Ÿ"},"children":[{"type":"text","value":"UUID (é€šç”¨å”¯ä¸€æ¨™è­˜ç¬¦è™Ÿ)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"UUID æ˜¯å–å¾—å”¯ä¸€ID çš„å¦ä¸€ç¨®ç°¡ä¾¿æ–¹æ³•ã€‚UUIDæ˜¯ä¸€å€‹128ä½å…ƒçš„æ•¸å­—ï¼Œå¯ç”¨ä¾†æ¨™è­˜é›»è…¦ç³»çµ±ä¸­çš„è³‡è¨Šã€‚UUID å‡ºç¾é‡è¤‡å€¼çš„æ©Ÿç‡éå¸¸ä½ã€‚ä»¥ä¸‹å…§å®¹å¼•è‡ªç¶­åŸºç™¾ç§‘ï¼Œã€Œå¦‚æœæ¯ç§’ç”¢ç”Ÿ10å„„å€‹UUIDï¼Œå¤§æ¦‚éœ€è¦ç¶“é100å¹´ä¹‹å¾Œï¼Œå‡ºç¾ä¸€æ¬¡é‡è¤‡å€¼çš„æ©Ÿç‡æ‰æœƒä¾†åˆ°50%ã€ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é€™è£¡å°±æœ‰ä¸€å€‹ UUID çš„ç¯„ä¾‹: "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"09c93c62-5064-468d-bf8a-c07e1040bfb2UUID"}]},{"type":"text","value":" å¯ç¨ç«‹ç”Ÿæˆï¼Œè€Œä¸éœ€è¦åœ¨ä¼ºæœå™¨ä¹‹é–“é€²è¡Œå”èª¿ã€‚åœ–7-3å‘ˆç¾çš„å°±æ˜¯UUID çš„è¨­è¨ˆã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Figure 7-3","src":"/code-study/images/sdi-aig/07/figure7-3.jpg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åœ¨é€™æ¨£çš„è¨­è¨ˆä¸‹ï¼Œæ¯å€‹ Web ä¼ºæœå™¨éƒ½æœ‰ä¸€å€‹IDç”Ÿæˆå™¨ï¼Œè€Œä¸”æ¯å€‹ Web ä¼ºæœå™¨éƒ½å¯ä»¥å„è‡ªç¨ç«‹ç”ŸæˆIDã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å„ªé»:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"UUID çš„ç”Ÿæˆå¾ˆç°¡å–®ã€‚ä¼ºæœå™¨ä¹‹é–“å®Œå…¨ä¸éœ€è¦é€²è¡Œå”èª¿ï¼Œå› æ­¤ä¸æœƒå‡ºç¾ä»»ä½•åŒæ­¥å•é¡Œã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"é€™å€‹ç³»çµ±å¾ˆå®¹æ˜“é€²è¡Œæ“´å±•ï¼Œå› ç‚ºæ¯å€‹ Web ä¼ºæœå™¨éƒ½å¯ä»¥è‡ªè¡Œç”Ÿæˆæ‰€"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"è¦ä½¿ç”¨çš„IDã€‚ID ç”Ÿæˆå™¨å¯éš¨è‘— Web ä¼ºæœå™¨è¼•é¬†é€²è¡Œæ“´å±•ã€‚"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç¼ºé»:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ID çš„é•·åº¦ç‚º128ä½å…ƒï¼Œä½†æˆ‘å€‘çš„è¦æ±‚æ˜¯64ä½å…ƒã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ID çš„å€¼ä¸¦ä¸æœƒéš¨è‘—æ™‚é–“éå¢ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ID æœ‰å¯èƒ½å‡ºç¾éæ•¸å­—çš„æƒ…æ³ã€‚"}]}]},{"type":"element","tag":"h4","props":{"id":"ç¥¨è­‰ä¼ºæœå™¨-ticket-server"},"children":[{"type":"text","value":"ç¥¨è­‰ä¼ºæœå™¨ (Ticket Server)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç¥¨è­‰ä¼ºæœå™¨(ticket server)æ˜¯å¦ä¸€ç¨®ç”Ÿæˆå”¯ä¸€ID çš„æœ‰è¶£æ–¹å¼ã€‚ç¥¨è­‰ä¼ºæœå™¨æ˜¯ç”± Flicker æ‰€é–‹ç™¼ï¼Œå¯ç”¨ä¾†ç”Ÿæˆåˆ†æ•£å¼çš„ä¸»éµ(primary key)ã€‚é€™å€‹ç³»çµ±çš„é‹ä½œæ–¹å¼å¾ˆå€¼å¾—ç‰¹åˆ¥ç­è§£ä¸€ä¸‹ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Figure 7-4","src":"/code-study/images/sdi-aig/07/figure7-4.jpg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å…¶æ§‹æƒ³å°±æ˜¯åœ¨å–®ä¸€è³‡æ–™åº«ä¼ºæœå™¨(ç¥¨è­‰ä¼ºæœå™¨)ä¸­ï¼Œä½¿ç”¨ä¸­å¤®ç®¡ç†å¼(centralized)çš„ auto_increment åŠŸèƒ½ã€‚å¦‚æœæƒ³è¦ç­è§£æ›´å¤šç›¸\nåƒè€ƒ Flicker çš„å·¥ç¨‹éƒ¨è½æ ¼æ–‡ç«  "},{"type":"element","tag":"a","props":{"href":"https://code.flickr.net/2010/02/08/ticket-servers-distributed-unique-primary-keys-on-the-cheap/","rel":["nofollow"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å„ªé»:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"æ•¸å­— IDã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"å¾ˆå®¹æ˜“é€²è¡Œå¯¦ä½œï¼Œè€Œä¸”å¯é©ç”¨æ–¼ä¸­å°å‹æ‡‰ç”¨ã€‚"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç¼ºé»:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"å¯èƒ½æœƒæœ‰å–®é»æ•…éšœçš„å•é¡Œã€‚ç”±æ–¼æ¡ç”¨å–®ä¸€çš„ç¥¨è­‰ä¼ºæœå™¨ï¼Œå› æ­¤ç¥¨è­‰ä¼ºæœå™¨è‹¥å‡ºç¾æ•…éšœï¼Œæ‰€æœ‰ä¾è³´å®ƒçš„ç³»çµ±å…¨éƒ½æœƒé‡åˆ°å•é¡Œã€‚ç‚ºäº†é¿å…å–®é»æ•…éšœï¼Œæˆ‘å€‘å¯ä»¥è¨­å®šå¤šéƒ¨ç¥¨è­‰ä¼ºæœå™¨ã€‚ä¸éï¼Œé€™ä¹Ÿæœƒå¸¶ä¾†æ–°çš„æŒ‘æˆ°ï¼Œä¾‹å¦‚è³‡æ–™åŒæ­¥çš„å•é¡Œã€‚"}]}]},{"type":"element","tag":"h5","props":{"id":"flickr-ticket-servers-distributed-unique-primary-keys-on-the-cheap"},"children":[{"type":"text","value":"Flickr: Ticket Servers â€” Distributed Unique Primary Keys on the Cheap"}]},{"type":"element","tag":"h6","props":{"id":"æ–‡ç« èƒŒæ™¯èˆ‡ç›®çš„"},"children":[{"type":"text","value":"æ–‡ç« èƒŒæ™¯èˆ‡ç›®çš„"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"åˆ†ç‰‡ï¼ˆShardingï¼‰èˆ‡ä¸»-ä¸»æ¶æ§‹"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nFlickr å°‡è³‡æ–™åˆ†ç‰‡å„²å­˜åœ¨å¤šè‡º MySQL ä¸Šï¼ŒåŒæ™‚æ¯å€‹åˆ†ç‰‡åˆæ¡ç”¨ä¸»â€”ä¸»ï¼ˆmasterâ€‘masterï¼‰è¤‡è£½ï¼Œä»¥æå‡å¯é æ€§èˆ‡æ“´å……èƒ½åŠ›ã€‚é€™ç¨®æ¶æ§‹ä¸‹ï¼Œå¿…é ˆç¢ºä¿æ‰€æœ‰åˆ†ç‰‡ç”Ÿæˆçš„ ID å…¨åŸŸå”¯ä¸€ï¼Œä»¥é¿å…ä¸»éµè¡çªã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"MySQL "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"AUTO_INCREMENT"}]},{"type":"text","value":" ç„¡æ³•è·¨ç¯€é»ä¿è­‰å”¯ä¸€æ€§"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\né›–ç„¶å–®å€‹ MySQL å¯¦ä¾‹å¯ä»¥ä¾¿åˆ©åœ°ä½¿ç”¨ "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"AUTO_INCREMENT"}]},{"type":"text","value":"ï¼Œä½†é€™åœ¨å¤šå¯¦ä¾‹é–“ä¸¦ç„¡å…¨åŸŸå”¯ä¸€ä¿éšœã€‚"}]}]},{"type":"element","tag":"h6","props":{"id":"ç‚ºä½•ä¸ä½¿ç”¨-guiduuid"},"children":[{"type":"text","value":"ç‚ºä½•ä¸ä½¿ç”¨ GUIDï¼ˆUUIDï¼‰ï¼Ÿ"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"GUID é«”ç©å¤§ã€ç´¢å¼•æ•ˆèƒ½å·®"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nGUID é›–ç„¶å¯ä¿è­‰å”¯ä¸€ï¼Œä½†å…¶å­—ä¸²é•·åº¦åŠéé †åºæ€§ï¼Œæœƒä½¿ç´¢å¼•é¾å¤§ä¸”é›£ä»¥ç¶­æŒåœ¨è¨˜æ†¶é«”ï¼Œå°è‡´æŸ¥è©¢æ€§èƒ½ä¸‹é™ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"ç¼ºä¹é †åºæ€§"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nFlickr éœ€è¦ ID æœ‰ä¸€å®šé †åºæ€§ï¼Œæœ‰åŠ©æ–¼å ±è¡¨ã€debugï¼Œä»¥åŠéƒ¨åˆ†å¿«å–ç­–ç•¥ï¼ŒGUID é›–å”¯ä¸€ä½†ä¸é©åˆæ­¤è™•éœ€æ±‚ã€‚"}]}]},{"type":"element","tag":"h6","props":{"id":"ä¸­å¤®-ticket-serverè§£æ±ºæ–¹æ¡ˆæ ¸å¿ƒ"},"children":[{"type":"text","value":"ä¸­å¤® Ticket Serverï¼šè§£æ±ºæ–¹æ¡ˆæ ¸å¿ƒ"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"ä½¿ç”¨ä¸­å¤® DB ç”Ÿæˆ ID"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nFlickr ä½¿ç”¨å°ˆé–€çš„ã€ŒTicket Serverã€ï¼Œæ˜¯ä¸€è‡ºå°ˆç”¨çš„ MySQLä¼ºæœå™¨ï¼Œåªå„²å­˜ç°¡åŒ–çš„ ID è¡¨ï¼ˆå¦‚ "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"Tickets64"}]},{"type":"text","value":"ï¼‰ã€‚é€éæ’å…¥ä¸€æ¢å›ºå®šçš„ stubï¼ˆstub æ¬„ä½ï¼‰å†å–å¾— "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"LAST_INSERT_ID()"}]},{"type":"text","value":"ï¼Œä»¥ç”¢ç”Ÿå…¨åŸŸå”¯ä¸€ã€é€£çºŒçš„ IDã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"REPLACE INTO"}]},{"type":"text","value":" æ©Ÿåˆ¶"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nä»–å€‘ä½¿ç”¨ MySQL çš„éæ¨™æº–èªæ³• "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"REPLACE INTO"}]},{"type":"text","value":"ï¼ˆå¦‚æœ stub å·²å­˜åœ¨ï¼Œå‰‡å…ˆåˆªé™¤å†æ’å…¥ï¼‰ï¼Œä¾†ç¢ºä¿æ¯æ¬¡æ’å…¥éƒ½æœƒè‡ªå‹•ç”¢ç”Ÿæ–°çš„ "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"AUTO_INCREMENT"}]},{"type":"text","value":" IDã€‚"}]}]},{"type":"element","tag":"h6","props":{"id":"é«˜å¯ç”¨è¨­è¨ˆé›™-ticket-serveré¿å…å–®é»æ•…éšœ"},"children":[{"type":"text","value":"é«˜å¯ç”¨è¨­è¨ˆï¼šé›™ Ticket Serverï¼ˆé¿å…å–®é»æ•…éšœï¼‰"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"é›™æ©Ÿéƒ¨ç½² + åˆ†éš” ID ç©ºé–“"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nç‚ºäº†é¿å… Ticket Server æˆç‚ºå–®é»æ•…éšœï¼ˆSPOFï¼‰ï¼Œæ¶è¨­å…©è‡ºä¼ºæœå™¨ï¼Œä¸¦æ¡ç”¨ "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"auto_increment_increment = 2"}]},{"type":"text","value":" æ­é…ä¸åŒçš„ "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"auto_increment_offset"}]},{"type":"text","value":"ï¼ˆåˆ†åˆ¥ç‚º 1 èˆ‡ 2ï¼‰ï¼Œä½¿ä¸€å°ç”¢ç”Ÿå¥‡æ•¸ IDï¼Œå¦ä¸€å°ç”¢ç”Ÿå¶æ•¸ IDï¼Œå†ä»¥ round-robin åˆ†é…è«‹æ±‚ã€‚"}]}]},{"type":"element","tag":"h6","props":{"id":"å…¶å®ƒå¯¦å‹™è¨­è¨ˆç´°ç¯€"},"children":[{"type":"text","value":"å…¶å®ƒå¯¦å‹™è¨­è¨ˆç´°ç¯€"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"å¤šç¨®é¡åˆ¥ ID (Sequences)"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nFlickr ä¸åªä¸€å¼µ "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"Tickets64"}]},{"type":"text","value":" è¡¨ï¼Œé‚„ç‚ºå„ç¨®å¯¦é«”ï¼ˆå¦‚ Photosã€Accountsã€OfflineTasksã€Groupsï¼‰è¨­è¨ˆç¨ç«‹åºåˆ—ï¼Œä»¥é¿å…å½¼æ­¤å¹²æ“¾èˆ‡å¿«é€Ÿæ¶ˆè€—ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"ç°¡å–®ä½†æœ‰æ•ˆçš„è¨­è¨ˆå“²å­¸"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\næ•´é«”æ–¹æ¡ˆé›–ä¸å„ªé›…ï¼Œä½†ç¬¦åˆ Flickr æ‰€è¬›æ±‚çš„ï¼šã€Œå·¥ç¨‹ä¸Šæœ€è ¢ä½†èƒ½é‹ä½œã€åŸå‰‡ï¼Œä¸”è‡ª 2006 å¹´å°±æŠ•å…¥ç”Ÿç”¢ä¸¦ç©©å®šé‹ä½œã€‚"}]}]},{"type":"element","tag":"h4","props":{"id":"twitteré›ªç‰‡snowflakeåšæ³•"},"children":[{"type":"text","value":"Twitteré›ªç‰‡(snowflake)åšæ³•"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å‰é¢æ‰€æåˆ°çš„ä¸€äº›åšæ³•ï¼Œåˆ†åˆ¥é‡å°ä¸åŒçš„ID ç”Ÿæˆç³»çµ±é‹ä½œåŸç†ï¼Œæä¾›äº†ä¸€äº›ä¸åŒçš„æ§‹æƒ³ã€‚ä¸éï¼Œé€™äº›åšæ³•å…¨éƒ½ä¸ç¬¦åˆæˆ‘å€‘çš„ç‰¹å®šè¦æ±‚ï¼Œå› æ­¤æˆ‘å€‘é‚„éœ€è¦å¦ä¸€ç¨®åšæ³•ã€‚Twitter çš„å”¯ä¸€ ID ç”Ÿæˆç³»çµ±å«åšã€Œsnowflake (é›ªç‰‡)ã€ï¼Œå…¶æ§‹æƒ³ç›¸ç•¶å…·æœ‰å•Ÿç™¼æ€§ï¼Œè€Œä¸”å¯ä»¥æ»¿è¶³æˆ‘å€‘çš„è¦æ±‚ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åˆ†è€Œæ²»ä¹‹(divide and conquer)çš„åˆ†æ²»åšæ³•ï¼Œå¯èªªæ˜¯æˆ‘å€‘çš„å¥½æœ‹å‹ã€‚æˆ‘å€‘æœƒæŠŠID åˆ†æˆä¸åŒçš„å¥½å¹¾æ®µï¼Œè€Œä¸æ˜¯ç›´æ¥ç”Ÿæˆæ•´å€‹IDã€‚åœ–7-5é¡¯ç¤ºçš„å°±æ˜¯64ä½å…ƒ IDçš„ä½ˆå±€æ–¹å¼ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Figure 7-5","src":"/code-study/images/sdi-aig/07/figure7-5.jpg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ¯ä¸€æ®µçš„èªªæ˜å¦‚ä¸‹ã€‚"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"ç¬¦è™Ÿä½å…ƒ"}]},{"type":"text","value":" : 1ä½å…ƒã€‚æ°¸é ç‚º0ã€‚ä¿ç•™ä»¥ä¾›æœªä¾†ä½¿ç”¨ã€‚å®ƒä¹Ÿè¨±å¯ç”¨ä¾†å€åˆ†æœ‰æ­£è² è™Ÿèˆ‡ç„¡æ­£è² è™Ÿçš„æ•¸å­—ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"æ™‚é–“æˆ³"}]},{"type":"text","value":" : 41 ä½å…ƒã€‚å¾æŸå€‹æ™‚é–“é»(å¯è‡ªå®šç¾©)ä»¥ä¾†æ‰€ç¶“éçš„æ¯«ç§’æ•¸ã€‚æˆ‘å€‘ä½¿ç”¨ Twitter é›ªç‰‡çš„é è¨­æ™‚é–“é»1288834974657ï¼Œé€™å€‹æ™‚é–“å°±ç›¸ç•¶æ–¼ UTC 2010å¹´11æœˆ4æ—¥01:42:54ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"è³‡æ–™ä¸­å¿ƒ ID"}]},{"type":"text","value":" : 5ä½å…ƒï¼Œé€™è£¡å¯ä»¥è®“æˆ‘å€‘ç”¨ä¾†å€åˆ†2^ 5 = 32 å€‹è³‡æ–™ä¸­å¿ƒã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"æ©Ÿå™¨ ID"}]},{"type":"text","value":" : 5ä½å…ƒï¼Œæ¯å€‹è³‡æ–™ä¸­å¿ƒå¯ä»¥æœ‰2 ^ 5 = 32 éƒ¨æ©Ÿå™¨ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"åºåˆ—ç·¨è™Ÿ"}]},{"type":"text","value":" : 12 ä½å…ƒã€‚åŒä¸€éƒ¨æ©Ÿå™¨/ process è¡Œç¨‹æ‰€ç”Ÿæˆçš„æ¯å€‹IDï¼Œå…¶åºåˆ—ç·¨è™Ÿæ¯æ¬¡éƒ½æœƒä»¥åŠ 1çš„æ–¹å¼é€æ¼¸éå¢ã€‚é€™å€‹æ•¸å­—æ¯æ¯«ç§’éƒ½æœƒé‡è¨­ç‚º0ã€‚"}]}]},{"type":"element","tag":"h3","props":{"id":"ç¬¬3æ­¥æ·±å…¥è¨­è¨ˆ"},"children":[{"type":"text","value":"ç¬¬3æ­¥ï¼šæ·±å…¥è¨­è¨ˆ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åœ¨é«˜éšè¨­è¨ˆä¸­ï¼Œæˆ‘å€‘å·²é‡å°åˆ†æ•£å¼ç³»çµ±è¨è«–éä¸€äº›å¯ç”¨ä¾†è¨­è¨ˆå”¯ä¸€ ID ç”Ÿæˆå™¨çš„å„ç¨®é¸é …ã€‚åœ¨é€™è£¡æˆ‘å€‘æœƒé¸æ“‡ Twitter é›ªç‰‡ ID ç”Ÿæˆå™¨åšç‚ºåƒè€ƒçš„åšæ³•ã€‚æ¥è‘—æˆ‘å€‘å°±ä¾†æ·±å…¥ç ”ç©¶ç›¸æ‡‰çš„è¨­è¨ˆã€‚ç‚ºäº†é‡æ–°å–šé†’æˆ‘å€‘çš„è¨˜æ†¶ï¼Œä¸‹é¢é‡æ–°åˆ—å‡ºç›¸æ‡‰çš„è¨­è¨ˆåœ–ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Figure 7-6","src":"/code-study/images/sdi-aig/07/figure7-6.jpg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"è³‡æ–™ä¸­å¿ƒ ID èˆ‡æ©Ÿå™¨ ID åœ¨å•Ÿå‹•æ™‚å°±å·²ç¶“é¸å®šï¼Œé€šå¸¸åœ¨ç³»çµ±å•Ÿå‹•ä¹‹å¾Œå°±å›ºå®šä¸å†æ”¹è®Šäº†ã€‚è³‡æ–™ä¸­å¿ƒ ID èˆ‡æ©Ÿå™¨ IDçš„ä»»ä½•ä¿®æ”¹ï¼Œéƒ½éœ€è¦é€²è¡Œä»”ç´°çš„æª¢æŸ¥ï¼Œå› ç‚ºå¦‚æœæ„å¤–ä¿®æ”¹äº†é€™äº›å€¼ï¼Œå°±æœ‰å¯èƒ½å°è‡´ID è¡çªçš„æƒ…æ³ã€‚ID ç”Ÿæˆå™¨åœ¨åŸ·è¡Œæ™‚ï¼Œæœƒç”Ÿæˆç›¸æ‡‰çš„æ™‚é–“æˆ³èˆ‡åºåˆ—ç·¨è™Ÿã€‚"}]},{"type":"element","tag":"h4","props":{"id":"æ™‚é–“æˆ³"},"children":[{"type":"text","value":"æ™‚é–“æˆ³"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æœ€é‡è¦çš„41ä½å…ƒï¼Œå°±æ˜¯ç”±æ™‚é–“æˆ³æ‰€æ§‹æˆã€‚æ™‚é–“æˆ³æœƒéš¨è‘—æ™‚é–“è€Œéå¢ï¼Œå› æ­¤ID ä¹Ÿæœƒéš¨è‘—æ™‚é–“è€Œéå¢ã€‚åœ–7-7 é¡¯ç¤ºçš„å°±æ˜¯å¦‚ä½•æŠŠäºŒé€²ä½è¡¨é”æ–¹å¼è½‰æ›ç‚º UTCçš„ç¯„ä¾‹ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨é¡ä¼¼çš„æ–¹æ³•ï¼ŒæŠŠUTC è½‰æ›å›äºŒé€²ä½è¡¨é”æ–¹å¼ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Figure 7-7","src":"/code-study/images/sdi-aig/07/figure7-7.jpg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"41 ä½å…ƒå¯ä»¥è¡¨é”çš„æœ€å¤§æ™‚é–“æˆ³ç‚º2 ^41-1 = 2199023255551 æ¯«ç§’(ms)ï¼Œç›¸ç•¶æ–¼:~ 69å¹´ = 2199023255551 æ¯«ç§’ / 1000 ç§’ / 365å¤© / 24å°æ™‚/3600 ç§’ã€‚é€™ä¹Ÿå°±è¡¨ç¤ºï¼Œé€™å€‹ID ç”Ÿæˆå™¨å¯æ­£å¸¸é‹ä½œ69å¹´ï¼Œå¦‚æœæ”¹ç”¨è‡ªå®šç¾©çš„æ–¹å¼ï¼ŒæŠŠèµ·ç®—æ™‚é–“(epoch time)è¨­å®šæˆæ›´æ¥è¿‘ä»Šå¤©çš„æ—¥æœŸï¼Œé‚„å¯ä»¥é€²ä¸€æ­¥å»¶å¾Œé€™å€‹å¯æ­£å¸¸é‹ä½œçš„æ™‚é–“ã€‚69å¹´ä¹‹å¾Œï¼Œæˆ‘å€‘å°±æœƒéœ€è¦å¦ä¸€å€‹æ–°çš„èµ·ç®—æ™‚é–“ï¼Œæˆ–æ˜¯æ”¹ç”¨å…¶ä»–æŠ€è¡“ä¾†å°é€™å€‹ID é€²è¡Œé·ç§»è½‰æ›ã€‚"}]},{"type":"element","tag":"h4","props":{"id":"åºåˆ—ç·¨è™Ÿ"},"children":[{"type":"text","value":"åºåˆ—ç·¨è™Ÿ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åºåˆ—ç·¨è™Ÿæœ‰12ä½å…ƒï¼Œé€™çµ¦äº†æˆ‘å€‘2 ^ 12 = 4096ç¨®çµ„åˆã€‚é™¤éåŒä¸€éƒ¨ä¼ºæœå™¨åœ¨ä¸€æ¯«ç§’ä¹‹å…§ç”Ÿæˆäº†å¤šå€‹IDï¼Œå¦å‰‡é€™å€‹æ¬„ä½çš„å€¼å°±æœƒæ˜¯0ã€‚ç†è«–ä¸Šä¾†èªªï¼ŒåŒä¸€éƒ¨æ©Ÿå™¨åœ¨æ¯æ¯«ç§’å…§æœ€å¤šå¯ç”Ÿæˆ4096å€‹æ–°çš„IDï¼Œå³ sequence (æ¯æ¯«ç§’æœ€å¤š 4096 ç­†)ã€‚"}]},{"type":"element","tag":"h3","props":{"id":"ç¬¬4æ­¥åŒ¯æ•´ç¸½çµ"},"children":[{"type":"text","value":"ç¬¬4æ­¥ï¼šåŒ¯æ•´ç¸½çµ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æˆ‘å€‘åœ¨æœ¬ç« è¨è«–äº†å¥½å¹¾ç¨®è¨­è¨ˆå”¯ä¸€ IDç”Ÿæˆå™¨çš„ä¸åŒåšæ³•:å¤š master è¤‡è£½ã€UUIDã€ç¥¨è­‰ä¼ºæœå™¨ï¼Œä»¥åŠ Twitter çš„é›ªç‰‡åšæ³•ã€‚æˆ‘å€‘æœ€å¾Œé¸æ“‡æ¡ç”¨é›ªç‰‡çš„åšæ³•ï¼Œå› ç‚ºå®ƒå¯æ”¯æ´æˆ‘å€‘æ‰€æœ‰çš„ä½¿ç”¨éœ€æ±‚ï¼Œè€Œä¸”å¯ä»¥åœ¨åˆ†æ•£å¼ç’°å¢ƒä¸‹é€²è¡Œæ“´å±•ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å¦‚æœåœ¨é¢è©¦çµæŸä¹‹å‰é‚„æœ‰å¤šé¤˜çš„æ™‚é–“ï¼Œé€™è£¡é‚„æœ‰ä¸€äº›å¯ä»¥é¡å¤–èŠèŠçš„æƒ³æ³•:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"æ™‚é˜åŒæ­¥ : åœ¨æˆ‘å€‘çš„è¨­è¨ˆä¸­ï¼Œæˆ‘å€‘å‡è¨­æ¯ä¸€éƒ¨ID ç”Ÿæˆä¼ºæœå™¨å…¨éƒ½å…·æœ‰ç›¸åŒçš„æ™‚é˜ã€‚å¦‚æœä¼ºæœå™¨æ˜¯åœ¨å¤šå€‹æ ¸å¿ƒä¸­åŸ·è¡Œï¼Œé€™å€‹å‡è¨­å°±æœ‰å¯èƒ½æ˜¯ä¸æ­£ç¢ºçš„ã€‚åœ¨ä½¿ç”¨å¤šéƒ¨æ©Ÿå™¨çš„åšæ³•ä¸­ï¼Œä¹Ÿå­˜åœ¨ç›¸åŒçš„æŒ‘æˆ°ã€‚æ™‚é˜åŒæ­¥è§£æ±ºæ–¹æ¡ˆä¸¦ä¸åœ¨æœ¬æ›¸çš„è¨è«–ç¯„åœä¹‹å…§ã€‚ä¸éï¼Œç­è§£é€™å€‹\nå•é¡Œçš„å­˜åœ¨æ˜¯å¾ˆé‡è¦çš„ã€‚æ¡ç”¨ç¶²è·¯æ™‚é–“å”å®š(NTP;Network TimeProtocol)ï¼Œå°±æ˜¯è§£æ±ºæ­¤å•é¡Œæœ€å—æ­¡è¿çš„ä¸€ç¨®åšæ³•ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"å„æ®µé•·åº¦çš„èª¿æ•´ : èˆ‰ä¾‹ä¾†èªªï¼Œæ”¹ç”¨æ¯”è¼ƒçŸ­çš„åºåˆ—ç·¨è™Ÿã€ä½†æ¡ç”¨æ¯”è¼ƒå¤šçš„æ™‚é–“æˆ³ä½å…ƒï¼Œå°æ–¼ä½ä¸¦è¡Œæ€§ã€è·¨è¶Šæ™‚é–“æ›´é•·çš„æ‡‰ç”¨è€Œè¨€ï¼Œæ˜¯ä¸€ç¨®æœ‰æ•ˆè€Œå¯è¡Œçš„åšæ³•ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"é«˜å¯ç”¨æ€§ : å°æ–¼å…¶ä»–ä»»å‹™ä¾†èªªï¼ŒID ç”Ÿæˆå™¨æ˜¯éå¸¸é‡è¦çš„ç³»çµ±ï¼Œå› æ­¤å®ƒå¿…é ˆå…·æœ‰å¾ˆé«˜çš„å¯ç”¨æ€§ã€‚"}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"ç¬¬1æ­¥äº†è§£å•é¡Œä¸¦ç¢ºç«‹è¨­è¨ˆçš„ç¯„åœ","depth":3,"text":"ç¬¬1æ­¥ï¼šäº†è§£å•é¡Œä¸¦ç¢ºç«‹è¨­è¨ˆçš„ç¯„åœ"},{"id":"ç¬¬2æ­¥æå‡ºé«˜éšè¨­è¨ˆä¸¦å–å¾—èªå¯","depth":3,"text":"ç¬¬2æ­¥ï¼šæå‡ºé«˜éšè¨­è¨ˆä¸¦å–å¾—èªå¯"},{"id":"ç¬¬3æ­¥æ·±å…¥è¨­è¨ˆ","depth":3,"text":"ç¬¬3æ­¥ï¼šæ·±å…¥è¨­è¨ˆ"},{"id":"ç¬¬4æ­¥åŒ¯æ•´ç¸½çµ","depth":3,"text":"ç¬¬4æ­¥ï¼šåŒ¯æ•´ç¸½çµ"}]}},"_type":"markdown","_id":"content:7.sdi-aig:7.chapter7.md","_source":"content","_file":"7.sdi-aig/7.chapter7.md","_extension":"md"}